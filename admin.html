<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Deadlock - Admin Panel</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #1a1a1a;
            color: #ffffff;
            margin: 0;
            padding: 0;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background-color: #000;
            padding: 15px 0;
            text-align: center;
            border-bottom: 1px solid #333;
            margin-bottom: 30px;
        }
        
        h1 {
            color: #f0c239;
            margin: 0;
            font-size: 28px;
        }
        
        .admin-panel {
            background-color: #2a2a2a;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.5);
        }
        
        .section-title {
            color: #f0c239;
            border-bottom: 1px solid #444;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        
        .item-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .item-card {
            background-color: #333;
            border-radius: 6px;
            padding: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
            position: relative;
        }
        
        .item-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        
        .item-card.selected {
            border-color: #f0c239;
            background-color: #444;
            box-shadow: 0 0 15px rgba(240, 194, 57, 0.5);
            z-index: 2;
        }
        
        .item-card.related {
            border-color: #4caf50;
            background-color: #3a3a3a;
            box-shadow: 0 0 15px rgba(76, 175, 80, 0.3);
            z-index: 1;
        }
        
        /* Preview mode styling */
        .preview-mode .item-card {
            filter: blur(2px) grayscale(80%);
            opacity: 0.5;
            transition: all 0.3s ease;
        }
        
        .preview-mode .item-card.selected,
        .preview-mode .item-card.related {
            filter: blur(0) grayscale(0);
            opacity: 1;
            transform: scale(1.05);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.5);
            z-index: 10;
        }
        
        .preview-container {
            margin: 20px 0;
            padding: 20px;
            background-color: #333;
            border-radius: 8px;
            border: 1px solid #444;
        }
        
        .preview-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .preview-header h3 {
            margin: 0;
            color: #f0c239;
        }
        
        .preview-toggle {
            background-color: #f0c239;
            color: #000;
            border: none;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.2s;
        }
        
        .preview-toggle:hover {
            background-color: #d9ad32;
        }
        
        .preview-description {
            margin-bottom: 15px;
            color: #ccc;
            font-style: italic;
        }
        
        .item-image {
            width: 80px;
            height: 80px;
            margin: 0 auto 8px;
            background-color: rgba(240, 194, 57, 0.1);
            border: 1px solid #f0c239;
            border-radius: 5px;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }
        
        .item-image img {
            max-width: 90%;
            max-height: 90%;
            object-fit: contain;
        }
        
        .item-name {
            font-size: 12px;
            color: #fff;
            margin-top: 5px;
        }
        
        .controls {
            margin: 20px 0;
            padding: 15px;
            background-color: #333;
            border-radius: 6px;
        }
        
        .btn {
            background-color: #f0c239;
            color: #000;
            border: none;
            padding: 10px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            margin-right: 10px;
            transition: all 0.2s;
        }
        
        .btn:hover {
            background-color: #d9ad32;
            transform: translateY(-2px);
        }
        
        .btn.save {
            background-color: #4caf50;
        }
        
        .btn.clear {
            background-color: #f44336;
        }
        
        .relationship-display {
            margin-top: 30px;
            background-color: #333;
            border-radius: 6px;
            padding: 15px;
        }
        
        .relationship-list {
            margin: 10px 0;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .relationship-item {
            background-color: #444;
            padding: 10px;
            margin-bottom: 8px;
            border-radius: 4px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .relationship-item .delete {
            color: #f44336;
            cursor: pointer;
            font-size: 18px;
        }
        
        .instructions {
            background-color: #333;
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 20px;
            border-left: 3px solid #f0c239;
        }
        
        .nav-link {
            display: inline-block;
            margin-top: 20px;
            color: #f0c239;
            text-decoration: none;
        }
        
        .nav-link:hover {
            text-decoration: underline;
        }
        
        /* Category tabs styling */
        .category-tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 1px solid #444;
        }
        
        .category-tab {
            padding: 10px 20px;
            cursor: pointer;
            font-weight: bold;
            border-radius: 5px 5px 0 0;
            margin-right: 5px;
        }
        
        .category-tab.active {
            background-color: #444;
        }
        
        .category-tab:hover {
            background-color: #333;
        }
        
        .category-tab.weapons {
            color: #f0c239;
            border-bottom: 3px solid #f0c239;
        }
        
        .category-tab.vitality {
            color: #4caf50;
            border-bottom: 3px solid #4caf50;
        }
        
        .category-tab.spirit {
            color: #9c27b0;
            border-bottom: 3px solid #9c27b0;
        }
        
        .category-content {
            display: none;
        }
        
        .category-content.active {
            display: block;
        }
    </style>
</head>
<body>
    <header>
        <h1>DEADLOCK ADMIN PANEL</h1>
    </header>
    
    <div class="container">
        <div class="instructions">
            <h3>Item Relationship Manager</h3>
            <p>Use this tool to define relationships between items. When a user clicks on an item on the main page, related items will be highlighted while others are dimmed.</p>
            <ol>
                <li>Select an item category (Weapons, Vitality, or Spirit)</li>
                <li>Click on an item to select it as the primary item</li>
                <li>Click on other items to establish relationships</li>
                <li>Click "Save Relationships" to save your changes</li>
            </ol>
            <p><strong>Important:</strong> When you save your relationships, the data will be automatically saved to the Relationships.json and data.json files. No downloads will happen.</p>
        </div>
        
        <div class="admin-panel">
            <h2 class="section-title">Select Items to Create Relationships</h2>
            
            <div class="category-tabs">
                <div class="category-tab weapons active" data-category="weapons">Weapons</div>
                <div class="category-tab vitality" data-category="vitality">Vitality</div>
                <div class="category-tab spirit" data-category="spirit">Spirit</div>
            </div>
            
            <div class="controls">
                <button id="save-btn" class="btn save">Save Relationships</button>
                <button id="clear-btn" class="btn clear">Clear Selection</button>
            </div>
            
            <div class="preview-container">
                <h3>Relationship Preview</h3>
                <button id="preview-toggle">Toggle Preview Mode</button>
                <p>Preview mode shows how items will appear on the main pages. Unrelated items are blurred, while related items remain clear.</p>
            </div>
            
            <div id="selection-info">Select a primary item first.</div>
            
            <!-- Weapons Category -->
            <div class="category-content weapons active" id="weapons-content">
                <h3>800 Gold Items</h3>
                <div class="item-container" id="weapons-800">
                    <!-- Items will be loaded here -->
                </div>
                
                <h3>1600 Gold Items</h3>
                <div class="item-container" id="weapons-1600">
                    <!-- Items will be loaded here -->
                </div>
                
                <h3>3200 Gold Items</h3>
                <div class="item-container" id="weapons-3200">
                    <!-- Items will be loaded here -->
                </div>
                
                <h3>6400 Gold Items</h3>
                <div class="item-container" id="weapons-6400">
                    <!-- Items will be loaded here -->
                </div>
            </div>
            
            <!-- Vitality Category -->
            <div class="category-content vitality" id="vitality-content">
                <h3>800 Gold Items</h3>
                <div class="item-container" id="vitality-800">
                    <!-- Items will be loaded here -->
                </div>
                
                <h3>1600 Gold Items</h3>
                <div class="item-container" id="vitality-1600">
                    <!-- Items will be loaded here -->
                </div>
                
                <h3>3200 Gold Items</h3>
                <div class="item-container" id="vitality-3200">
                    <!-- Items will be loaded here -->
                </div>
                
                <h3>6400 Gold Items</h3>
                <div class="item-container" id="vitality-6400">
                    <!-- Items will be loaded here -->
                </div>
            </div>
            
            <!-- Spirit Category -->
            <div class="category-content spirit" id="spirit-content">
                <h3>800 Gold Items</h3>
                <div class="item-container" id="spirit-800">
                    <!-- Items will be loaded here -->
                </div>
                
                <h3>1600 Gold Items</h3>
                <div class="item-container" id="spirit-1600">
                    <!-- Items will be loaded here -->
                </div>
                
                <h3>3200 Gold Items</h3>
                <div class="item-container" id="spirit-3200">
                    <!-- Items will be loaded here -->
                </div>
                
                <h3>6400 Gold Items</h3>
                <div class="item-container" id="spirit-6400">
                    <!-- Items will be loaded here -->
                </div>
            </div>
            
            <div class="relationship-display">
                <h3>Current Relationships</h3>
                <div class="relationship-list" id="relationship-list">
                    <!-- Relationships will be shown here -->
                </div>
            </div>
        </div>
        
        <a href="index.html" class="nav-link">← Back to Main Page</a>
    </div>

    <script>
        // Item data organized by category and price
        const itemData = {
            weapons: {
                '800': [
                    { id: 'extended-magazine', name: 'Extended Magazine', image: 'images/weapons/800/extended.png' },
                    { id: 'rapid-rounds', name: 'Rapid Rounds', image: 'images/weapons/800/Rapid_rounds.png' },
                    { id: 'monster-rounds', name: 'Monster Rounds', image: 'images/weapons/800/Monster_rounds.png' },
                    { id: 'high-velocity', name: 'High Velocity', image: 'images/weapons/800/high-velocity.png' },
                    { id: 'headshot-booster', name: 'Headshot Booster', image: 'images/weapons/800/headshot_booster.png' },
                    { id: 'close-quarters', name: 'Close Quarters', image: 'images/weapons/800/close_quraters.png' },
                    { id: 'restorative-shot', name: 'Restorative Shot', image: 'images/weapons/800/restorative_shot.png' }
                ],
                '1600': [
                    { id: 'active-reload', name: 'Active Reload', image: 'images/weapons/1600/Active_reload.png' },
                    { id: 'backstabber', name: 'Backstabber', image: 'images/weapons/1600/backtabber.png' },
                    { id: 'fleetfoot', name: 'Fleetfoot', image: 'images/weapons/1600/fleetfoot.png' },
                    { id: 'intensifying-magazine', name: 'Intensifying Magazine', image: 'images/weapons/1600/intensitfying_magazine.png' },
                    { id: 'kinetic-dash', name: 'Kinetic Dash', image: 'images/weapons/1600/kinentic_dash.png' },
                    { id: 'long-range', name: 'Long Range', image: 'images/weapons/1600/long_Range.png' },
                    { id: 'melee-charge', name: 'Melee Charge', image: 'images/weapons/1600/melee_charge.png' },
                    { id: 'opening-rounds', name: 'Opening Rounds', image: 'images/weapons/1600/opening_rounds.png' },
                    { id: 'slowing-bullets', name: 'Slowing Bullets', image: 'images/weapons/1600/slowing_bullets.png' },
                    { id: 'split-shot', name: 'Split Shot', image: 'images/weapons/1600/split_shot.png' },
                    { id: 'spirit-shredder-bullets', name: 'Spirit Shredder Bullets', image: 'images/weapons/1600/spirit shredder bullets.png' },
                    { id: 'titanic-magazine', name: 'Titanic Magazine', image: 'images/weapons/1600/Titanic_Magazine.png' },
                    { id: 'swift-striker', name: 'Swift Striker', image: 'images/weapons/1600/swift_striker.png' }
                ],
                '3200': [
                    { id: 'alchemical-fire', name: 'Alchemical Fire', image: 'images/weapons/3200/Alchmical_fire.png' },
                    { id: 'berserker', name: 'Berserker', image: 'images/weapons/3200/Berserker.png' },
                    { id: 'blood-tribute', name: 'Blood Tribute', image: 'images/weapons/3200/blood_Tribute.png' },
                    { id: 'burst-fire', name: 'Burst Fire', image: 'images/weapons/3200/burst_fire.png' },
                    { id: 'cultist-sacrifice', name: 'Cultist Sacrifice', image: 'images/weapons/3200/cultist_sarcrifice.png' },
                    { id: 'escalating-resilience', name: 'Escalating Resilience', image: 'images/weapons/3200/escalating_resilience.png' },
                    { id: 'express-shot', name: 'Express Shot', image: 'images/weapons/3200/express_shot.png' },
                    { id: 'headhunter', name: 'Headhunter', image: 'images/weapons/3200/headhunter.png' },
                    { id: 'heroic-aura', name: 'Heroic Aura', image: 'images/weapons/3200/heroic_Aura.png' },
                    { id: 'hollow-point', name: 'Hollow Point', image: 'images/weapons/3200/Hollow_polint.png' },
                    { id: 'hunters-aura', name: 'Hunter\'s Aura', image: 'images/weapons/3200/hunter_Aura.png' },
                    { id: 'point-blank', name: 'Point Blank', image: 'images/weapons/3200/point_blank.png' },
                    { id: 'sharpshooter', name: 'Sharpshooter', image: 'images/weapons/3200/sharpshooter.png' },
                    { id: 'spirit-rend', name: 'Spirit Rend', image: 'images/weapons/3200/Spirit_rend.png' },
                    { id: 'tesla-bullets', name: 'Tesla Bullets', image: 'images/weapons/3200/teska_bullets.png' },
                    { id: 'toxic-bullets', name: 'Toxic Bullets', image: 'images/weapons/3200/toxix_bullets.png' },
                    { id: 'weighted-shots', name: 'Weighted Shots', image: 'images/weapons/3200/weighted_shots.png' }
                ],
                '6400': [
                    { id: 'armor-piercing-rounds', name: 'Armor Piercing Rounds', image: 'images/weapons/6400/armor_plerdrg_rounds.png' },
                    { id: 'capacitor', name: 'Capacitor', image: 'images/weapons/6400/Capacitor.png' },
                    { id: 'crippling-headshot', name: 'Crippling Headshot', image: 'images/weapons/6400/Crippling_Headshot.png' },
                    { id: 'crushing-fists', name: 'Crushing Fists', image: 'images/weapons/6400/Crushing_Fists.png' },
                    { id: 'frenzy', name: 'Frenzy', image: 'images/weapons/6400/Frenzy.PNG' },
                    { id: 'glass-cannon', name: 'Glass Cannon', image: 'images/weapons/6400/Glass_Cannon.png' },
                    { id: 'lucky-shot', name: 'Lucky Shot', image: 'images/weapons/6400/Lucky_Shot.png' },
                    { id: 'ricochet', name: 'Ricochet', image: 'images/weapons/6400/Lucky_Shot.png' },
                    { id: 'shadow-weave', name: 'Shadow Weave', image: 'images/weapons/6400/Shadow_Weave.png' },
                    { id: 'silencer', name: 'Silencer', image: 'images/weapons/6400/Silencer.png' },
                    { id: 'spellslinger', name: 'Spellslinger', image: 'images/weapons/6400/Soellslineer.png' },
                    { id: 'spiritual-overflow', name: 'Spiritual Overflow', image: 'images/weapons/6400/Spiritual_Overflow.png' }
                ]
            },
            vitality: {
                '800': [
                    { id: 'extra-stamina', name: 'Extra Stamina', image: 'images/vitality/800/Extra_Stamina.png' },
                    { id: 'healing-rite', name: 'Healing Rite', image: 'images/vitality/800/Healing_Rite.png' },
                    { id: 'rebuttal', name: 'Rebuttal', image: 'images/vitality/800/Rebuttal.png' },
                    { id: 'sprint-boots', name: 'Sprint Boots', image: 'images/vitality/800/Sprint_Boots.png' },
                    { id: 'extra-regen', name: 'Extra Regen', image: 'images/vitality/800/Extra_Regen.png' },
                    { id: 'extra-health', name: 'Extra Health', image: 'images/vitality/800/Extra_Health.png' },
                    { id: 'melee-lifesteal', name: 'Melee Lifesteal', image: 'images/vitality/800/Melee_Lifesteal.png' }
                ],
                '1600': [
                    { id: 'weapon-shielding', name: 'Weapon Shielding', image: 'images/vitality/1600/Weapon_Shielding.png' },
                    { id: 'spirit-shielding', name: 'Spirit Shielding', image: 'images/vitality/1600/Spirit_Shielding.png' },
                    { id: 'spirit-lifesteal', name: 'Spirit Lifesteal', image: 'images/vitality/1600/Spirit_Lifesteal.png' },
                    { id: 'return-fire', name: 'Return Fire', image: 'images/vitality/1600/Return_Fire.png' },
                    { id: 'restorative-locket', name: 'Restorative Locket', image: 'images/vitality/1600/Restorative_Locket.png' },
                    { id: 'reactive-barrier', name: 'Reactive Barrier', image: 'images/vitality/1600/Reactive_Barrier.png' },
                    { id: 'healing-nova', name: 'Healing Nova', image: 'images/vitality/1600/Healing_Nova.png' },
                    { id: 'healing-booster', name: 'Healing Booster', image: 'images/vitality/1600/Healine_Booster.png' },
                    { id: 'healbane', name: 'Healbane', image: 'images/vitality/1600/Healbane.png' },
                    { id: 'guardian-ward', name: 'Guardian Ward', image: 'images/vitality/1600/Guardian_Ward.png' },
                    { id: 'enduring-speed', name: 'Enduring Speed', image: 'images/vitality/1600/Enduring_Speed.png' },
                    { id: 'enchanters-emblem', name: 'Enchanter\'s Emblem', image: 'images/vitality/1600/Enchanter\'s_Emblem.png' },
                    { id: 'debuff-reducer', name: 'Debuff Reducer', image: 'images/vitality/1600/Debuff_Reducer.png' },
                    { id: 'bullet-lifesteal', name: 'Bullet Lifesteal', image: 'images/vitality/1600/Bullet_Lifesteal.png' },
                    { id: 'battle-vest', name: 'Battle Vest', image: 'images/vitality/1600/Battle_Vest.png' }
                ],
                '3200': [
                    { id: 'bullet-resilience', name: 'Bullet Resilience', image: 'images/vitality/3200/Bullet_Resilience.png' },
                    { id: 'counterspell', name: 'Counterspell', image: 'images/vitality/3200/Counterspell.png' },
                    { id: 'debuff-remover', name: 'Debuff Remover', image: 'images/vitality/3200/Debuff_Remover.png' },
                    { id: 'fortitude', name: 'Fortitude', image: 'images/vitality/3200/Fortitude.png' },
                    { id: 'fury-trance', name: 'Fury Trance', image: 'images/vitality/3200/Fury_Trance.png' },
                    { id: 'lifestrike', name: 'Lifestrike', image: 'images/vitality/3200/Lifestrike.png' },
                    { id: 'majestic-leap', name: 'Majestic Leap', image: 'images/vitality/3200/Majestic_Leap.png' },
                    { id: 'metal-skin', name: 'Metal Skin', image: 'images/vitality/3200/Metal_Skin.png' },
                    { id: 'rescue-beam', name: 'Rescue Beam', image: 'images/vitality/3200/Rescue_Beam.png' },
                    { id: 'spirit-resilience', name: 'Spirit Resilience', image: 'images/vitality/3200/Spirit_Resilience.png' },
                    { id: 'stamina-mastery', name: 'Stamina Mastery', image: 'images/vitality/3200/Stamina_Mastery.png' },
                    { id: 'trophy-collector', name: 'Trophy Collector', image: 'images/vitality/3200/Trophy_Collector.png' },
                    { id: 'veil-walker', name: 'Veil Walker', image: 'images/vitality/3200/Veil_Walker.png' },
                    { id: 'warp-stone', name: 'Warp Stone', image: 'images/vitality/3200/Warp_Stone.png' }
                ],
                '6400': [
                    { id: 'cheat-death', name: 'Cheat Death', image: 'images/vitality/6400/Cheat_Death.png' },
                    { id: 'colossus', name: 'Colossus', image: 'images/vitality/6400/Colossus.png' },
                    { id: 'divine-barrier', name: 'Divine Barrier', image: 'images/vitality/6400/Divine_Barrier.png' },
                    { id: 'diviners-kevlar', name: 'Diviner\'s Kevlar', image: 'images/vitality/6400/Diviner\'s_Kevlar.png' },
                    { id: 'healing-tempo', name: 'Healing Tempo', image: 'images/vitality/6400/Healing_Tempo.png' },
                    { id: 'infuser', name: 'Infuser', image: 'images/vitality/6400/Infuser.png' },
                    { id: 'inhibitor', name: 'Inhibitor', image: 'images/vitality/6400/Inhibitor.png' },
                    { id: 'juggernaut', name: 'Juggernaut', image: 'images/vitality/6400/Juggernaut.png' },
                    { id: 'leech', name: 'Leech', image: 'images/vitality/6400/Leech.png' },
                    { id: 'phantom-strike', name: 'Phantom Strike', image: 'images/vitality/6400/Phantom_Strike.png' },
                    { id: 'plated-armor', name: 'Plated Armor', image: 'images/vitality/6400/Plated_Armor.png' },
                    { id: 'siphon-bullets', name: 'Siphon Bullets', image: 'images/vitality/6400/Siphon_Bullets.png' },
                    { id: 'spellbreaker', name: 'Spellbreaker', image: 'images/vitality/6400/Spellbreaker.png' },
                    { id: 'unstoppable', name: 'Unstoppable', image: 'images/vitality/6400/Unstoppable.png' },
                    { id: 'vampiric-burst', name: 'Vampiric Burst', image: 'images/vitality/6400/Vampiric_Burst.png' },
                    { id: 'witchmail', name: 'Witchmail', image: 'images/vitality/6400/Witchmail.png' }
                ]
            },
            spirit: {
                '800': [
                    { id: 'extra-charge', name: 'Extra Charge', image: 'images/spirit/800/Extra_Charge.png' },
                    { id: 'extra-spirit', name: 'Extra Spirit', image: 'images/spirit/800/Extra_Spirit.png' },
                    { id: 'mystic-burst', name: 'Mystic Burst', image: 'images/spirit/800/Mystic_Burst.png' },
                    { id: 'mystic-expansion', name: 'Mystic Expansion', image: 'images/spirit/800/Mystic_Expansion.png' },
                    { id: 'mystic-regeneration', name: 'Mystic Regeneration', image: 'images/spirit/800/Mystic_Regeneration.png' },
                    { id: 'rusted-barrel', name: 'Rusted Barrel', image: 'images/spirit/800/Rusted_Barrel.png' },
                    { id: 'spirit-strike', name: 'Spirit Strike', image: 'images/spirit/800/Spirit_Strike.png' }
                ],
                '1600': [
                    { id: 'arcane-surge', name: 'Arcane Surge', image: 'images/spirit/1600/Arcane_Surge.png' },
                    { id: 'bullet-resist-shredder', name: 'Bullet Resist Shredder', image: 'images/spirit/1600/Bullet_Resist_Shredder.png' },
                    { id: 'cold-front', name: 'Cold Front', image: 'images/spirit/1600/Cold_Front.png' },
                    { id: 'compress-cooldown', name: 'Compress Cooldown', image: 'images/spirit/1600/Compress_Cooldown.png' },
                    { id: 'duration-extender', name: 'Duration Extender', image: 'images/spirit/1600/Duration_Extender.png' },
                    { id: 'improved-spirit', name: 'Improved Spirit', image: 'images/spirit/1600/Improved_Spirit.png' },
                    { id: 'mystic-slow', name: 'Mystic Slow', image: 'images/spirit/1600/Mystic_Slow.png' },
                    { id: 'mystic-vulnerability', name: 'Mystic Vulnerability', image: 'images/spirit/1600/Mystic_Vulnerability.png' },
                    { id: 'quicksilver-reload', name: 'Quicksilver Reload', image: 'images/spirit/1600/Quicksilver_Reload.png' },
                    { id: 'slowing-hex', name: 'Slowing Hex', image: 'images/spirit/1600/Slowing_Hex.png' },
                    { id: 'spirit-sap', name: 'Spirit Sap', image: 'images/spirit/1600/Spirit_Sap.png' },
                    { id: 'suppressor', name: 'Suppressor', image: 'images/spirit/1600/Suppressor.png' }
                ],
                '3200': [
                    { id: 'decay', name: 'Decay', image: 'images/spirit/3200/Decay.png' },
                    { id: 'disarming-hex', name: 'Disarming Hex', image: 'images/spirit/3200/Disarming_Hex.png' },
                    { id: 'greater-expansion', name: 'Greater Expansion', image: 'images/spirit/3200/Greater_Expansion.png' },
                    { id: 'knockdown', name: 'Knockdown', image: 'images/spirit/3200/Knockdown.png' },
                    { id: 'rapid-recharge', name: 'Rapid Recharge', image: 'images/spirit/3200/Rapid_Recharge.png' },
                    { id: 'silence-wave', name: 'Silence Wave', image: 'images/spirit/3200/Silence_Wave.png' },
                    { id: 'spirit-snatch', name: 'Spirit Snatch', image: 'images/spirit/3200/Spirit_Snatch.png' },
                    { id: 'superior-cooldown', name: 'Superior Cooldown', image: 'images/spirit/3200/Superior_Cooldown.png' },
                    { id: 'superior-duration', name: 'Superior Duration', image: 'images/spirit/3200/Superior_Duration.png' },
                    { id: 'surge-of-power', name: 'Surge of Power', image: 'images/spirit/3200/Surge_of_Power.png' },
                    { id: 'tankbuster', name: 'Tankbuster', image: 'images/spirit/3200/Tankbuster.png' },
                    { id: 'torment-pulse', name: 'Torment Pulse', image: 'images/spirit/3200/Torment_Pulse.png' }
                ],
                '6400': [
                    { id: 'arctic-blast', name: 'Arctic Blast', image: 'images/spirit/6400/Arctic_Blast.png' },
                    { id: 'boundless-spirit', name: 'Boundless Spirit', image: 'images/spirit/6400/Boundless_Spirit.png' },
                    { id: 'curse', name: 'Curse', image: 'images/spirit/6400/Curse.png' },
                    { id: 'echo-shard', name: 'Echo Shard', image: 'images/spirit/6400/Echo_Shard.png' },
                    { id: 'escalating-exposure', name: 'Escalating Exposure', image: 'images/spirit/6400/Escalating_Exposure.png' },
                    { id: 'ethereal-shift', name: 'Ethereal Shift', image: 'images/spirit/6400/Ethereal_Shift.png' },
                    { id: 'focus-lens', name: 'Focus Lens', image: 'images/spirit/6400/Focus_Lens.png' },
                    { id: 'lightning-scroll', name: 'Lightning Scroll', image: 'images/spirit/6400/Lightning_Scroll.png' },
                    { id: 'magic-carpet', name: 'Magic Carpet', image: 'images/spirit/6400/Magic_Carpet.png' },
                    { id: 'mercurial-magnum', name: 'Mercurial Magnum', image: 'images/spirit/6400/Mercurial_Magnum.png' },
                    { id: 'mystic-reverb', name: 'Mystic Reverb', image: 'images/spirit/6400/Mystic_Reverb.png' },
                    { id: 'scourge', name: 'Scourge', image: 'images/spirit/6400/Scourge.png' },
                    { id: 'spirit-burn', name: 'Spirit Burn', image: 'images/spirit/6400/image copy.png' },
                    { id: 'vortex-web', name: 'Vortex Web', image: 'images/spirit/6400/Vortex_Web.png' }
                ]
            }
        };
        
        // Relationship storage - will store relationships for all categories
        let relationships = {
            weapons: {},
            vitality: {},
            spirit: {}
        };
        
        let selectedItem = null;
        let relatedItems = [];
        let currentCategory = 'weapons';
        
        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            loadItems();
            
            // Load relationships from localStorage
            loadRelationshipsFromFiles().then(() => {
                loadRelationships();
                setupEventListeners();
            });
            
            showMessage('Ready to create item relationships. Changes will be saved to browser storage.', 'info');
        });
        
        // Load relationships from localStorage
        async function loadRelationshipsFromFiles() {
            try {
                // Check if we have saved relationships in localStorage
                const hasWeaponsRelationships = localStorage.getItem('weaponsRelationships');
                const hasVitalityRelationships = localStorage.getItem('vitalityRelationships');
                const hasSpiritRelationships = localStorage.getItem('spiritRelationships');
                
                if (hasWeaponsRelationships || hasVitalityRelationships || hasSpiritRelationships) {
                    // Start with empty relationships
                    relationships = {
                        weapons: {},
                        vitality: {},
                        spirit: {}
                    };
                    
                    // Load each category if available
                    if (hasWeaponsRelationships) {
                        relationships.weapons = JSON.parse(hasWeaponsRelationships);
                    }
                    if (hasVitalityRelationships) {
                        relationships.vitality = JSON.parse(hasVitalityRelationships);
                    }
                    if (hasSpiritRelationships) {
                        relationships.spirit = JSON.parse(hasSpiritRelationships);
                    }
                    
                    showMessage('Loaded relationships from browser storage', 'success');
                    return;
                }
                
                // If we get here, no localStorage data was found
                showMessage('No saved relationship data found in browser storage', 'info');
            } catch (error) {
                console.error('Error loading relationships:', error);
                showMessage('Could not load relationship data', 'warning');
            }
        }
        
        // Load items into the containers
        function loadItems() {
            // Load weapons items
            for (const price of ['800', '1600', '3200', '6400']) {
                const container = document.getElementById(`weapons-${price}`);
                itemData.weapons[price].forEach(item => {
                    container.appendChild(createItemCard(item));
                });
            }
            
            // Load vitality items
            for (const price of ['800', '1600', '3200', '6400']) {
                const container = document.getElementById(`vitality-${price}`);
                itemData.vitality[price].forEach(item => {
                    container.appendChild(createItemCard(item));
                });
            }
            
            // Load spirit items
            for (const price of ['800', '1600', '3200', '6400']) {
                const container = document.getElementById(`spirit-${price}`);
                itemData.spirit[price].forEach(item => {
                    container.appendChild(createItemCard(item));
                });
            }
        }
        
        // Create an item card element
        function createItemCard(item) {
            const card = document.createElement('div');
            card.className = 'item-card';
            card.dataset.id = item.id;
            card.dataset.name = item.name;
            
            const imageContainer = document.createElement('div');
            imageContainer.className = 'item-image';
            
            const img = document.createElement('img');
            img.src = item.image;
            img.alt = item.name;
            img.onerror = function() {
                this.onerror = null;
                this.src = 'images/placeholder.png';
            };
            
            const name = document.createElement('div');
            name.className = 'item-name';
            name.textContent = item.name;
            
            imageContainer.appendChild(img);
            card.appendChild(imageContainer);
            card.appendChild(name);
            
            return card;
        }
        
        // Load existing relationships
        function loadRelationships() {
            const relationshipList = document.getElementById('relationship-list');
            relationshipList.innerHTML = '';
            
            const categoryRelationships = relationships[currentCategory];
            
            for (const [item, relatedItems] of Object.entries(categoryRelationships)) {
                const relationshipItem = document.createElement('div');
                relationshipItem.className = 'relationship-item';
                
                const text = document.createElement('div');
                text.textContent = `${item} → ${relatedItems.join(', ')}`;
                
                const deleteBtn = document.createElement('span');
                deleteBtn.className = 'delete';
                deleteBtn.textContent = '×';
                deleteBtn.dataset.item = item;
                
                relationshipItem.appendChild(text);
                relationshipItem.appendChild(deleteBtn);
                relationshipList.appendChild(relationshipItem);
            }
        }
        
        // Set up event listeners
        function setupEventListeners() {
            // Category tab switching
            document.querySelectorAll('.category-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    const category = this.dataset.category;
                    switchCategory(category);
                });
            });
            
            // Item selection
            document.querySelectorAll('.item-card').forEach(card => {
                card.addEventListener('click', function() {
                    const itemName = this.dataset.name;
                    
                    if (!selectedItem) {
                        // Select as primary item
                        selectedItem = itemName;
                        this.classList.add('selected');
                        document.getElementById('selection-info').textContent = `Primary item: ${selectedItem}. Now select related items.`;
                        
                        // Load existing related items if any
                        if (relationships[currentCategory][selectedItem]) {
                            relatedItems = [...relationships[currentCategory][selectedItem]];
                            highlightRelatedItems();
                        }
                    } else if (itemName === selectedItem) {
                        // Deselect primary item
                        this.classList.remove('selected');
                        clearSelection();
                    } else {
                        // Toggle as related item
                        const index = relatedItems.indexOf(itemName);
                        if (index === -1) {
                            relatedItems.push(itemName);
                            this.classList.add('related');
                        } else {
                            relatedItems.splice(index, 1);
                            this.classList.remove('related');
                        }
                    }
                });
            });
            
            // Save button
            document.getElementById('save-btn').addEventListener('click', function() {
                if (selectedItem && relatedItems.length > 0) {
                    // Update relationships
                    if (!relationships[currentCategory][selectedItem]) {
                        relationships[currentCategory][selectedItem] = [];
                    }
                    relationships[currentCategory][selectedItem] = [...relatedItems];
                    
                    // Update relationships for each related item
                    relatedItems.forEach(item => {
                        if (!relationships[currentCategory][item]) {
                            relationships[currentCategory][item] = [];
                        }
                        if (!relationships[currentCategory][item].includes(selectedItem)) {
                            relationships[currentCategory][item].push(selectedItem);
                        }
                    });
                    
                    // Save to localStorage and file
                    saveRelationships();
                    
                    // Reload relationships display
                    loadRelationships();
                    
                    // Clear selection
                    clearSelection();
                } else {
                    alert('Please select a primary item and at least one related item.');
                }
            });
            
            // Clear button
            document.getElementById('clear-btn').addEventListener('click', clearSelection);
            
            // Preview toggle button
            document.getElementById('preview-toggle').addEventListener('click', function() {
                const categoryContent = document.getElementById(`${currentCategory}-content`);
                categoryContent.classList.toggle('preview-mode');
                
                if (categoryContent.classList.contains('preview-mode')) {
                    this.textContent = 'Exit Preview Mode';
                    this.style.backgroundColor = '#4caf50';
                } else {
                    this.textContent = 'Toggle Preview Mode';
                    this.style.backgroundColor = '#f0c239';
                }
            });
            
            // Delete relationship
            document.addEventListener('click', function(e) {
                if (e.target.classList.contains('delete')) {
                    const item = e.target.dataset.item;
                    
                    // Remove relationships
                    const relatedItems = relationships[currentCategory][item];
                    delete relationships[currentCategory][item];
                    
                    // Remove reverse relationships
                    relatedItems.forEach(relatedItem => {
                        if (relationships[currentCategory][relatedItem]) {
                            const index = relationships[currentCategory][relatedItem].indexOf(item);
                            if (index !== -1) {
                                relationships[currentCategory][relatedItem].splice(index, 1);
                                
                                // Remove empty arrays
                                if (relationships[currentCategory][relatedItem].length === 0) {
                                    delete relationships[currentCategory][relatedItem];
                                }
                            }
                        }
                    });
                    
                    // Save to localStorage
                    saveRelationships();
                    
                    // Reload relationships display
                    loadRelationships();
                }
            });
        }
        
        // Save relationships to localStorage for other pages to use
        function saveRelationships() {
            // Save to localStorage
            localStorage.setItem('weaponsRelationships', JSON.stringify(relationships.weapons));
            localStorage.setItem('vitalityRelationships', JSON.stringify(relationships.vitality));
            localStorage.setItem('spiritRelationships', JSON.stringify(relationships.spirit));
            
            showMessage('Relationships saved successfully to browser storage!', 'success');
            showMessage('Reload the weapon, vitality, or spirit pages to see the relationships', 'info');
        }
        
        // Function to show status messages
        function showMessage(message, type) {
            const savedMsg = document.createElement('div');
            savedMsg.style.position = 'fixed';
            savedMsg.style.top = '20px';
            savedMsg.style.left = '50%';
            savedMsg.style.transform = 'translateX(-50%)';
            savedMsg.style.padding = '10px 20px';
            savedMsg.style.color = 'white';
            savedMsg.style.borderRadius = '4px';
            savedMsg.style.zIndex = '9999';
            savedMsg.style.boxShadow = '0 2px 10px rgba(0,0,0,0.3)';
            savedMsg.textContent = message;
            
            // Set color based on message type
            if (type === 'success') {
                savedMsg.style.backgroundColor = '#4caf50';
            } else if (type === 'error') {
                savedMsg.style.backgroundColor = '#f44336';
            } else if (type === 'warning') {
                savedMsg.style.backgroundColor = '#ff9800';
            } else if (type === 'info') {
                savedMsg.style.backgroundColor = '#2196F3';
            }
            
            document.body.appendChild(savedMsg);
            
            setTimeout(() => {
                savedMsg.style.opacity = '0';
                savedMsg.style.transition = 'opacity 0.5s ease';
                setTimeout(() => {
                    document.body.removeChild(savedMsg);
                }, 500);
            }, 5000);
        }
        
        // Switch between categories
        function switchCategory(category) {
            // Update current category
            currentCategory = category;
            
            // Update active tab
            document.querySelectorAll('.category-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelector(`.category-tab.${category}`).classList.add('active');
            
            // Update visible content
            document.querySelectorAll('.category-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(`${category}-content`).classList.add('active');
            
            // Clear any selections
            clearSelection();
            
            // Update relationships display
            loadRelationships();
        }
        
        // Highlight related items
        function highlightRelatedItems() {
            // Clear existing highlights first
            document.querySelectorAll('.item-card').forEach(card => {
                card.classList.remove('related');
            });
            
            // Apply highlights to related items
            relatedItems.forEach(item => {
                const card = document.querySelector(`.item-card[data-name="${item}"]`);
                if (card) {
                    card.classList.add('related');
                }
            });
        }
        
        // Clear selection
        function clearSelection() {
            document.querySelectorAll('.item-card').forEach(card => {
                card.classList.remove('selected');
                card.classList.remove('related');
            });
            
            selectedItem = null;
            relatedItems = [];
            document.getElementById('selection-info').textContent = 'Select a primary item first.';
        }
    </script>
</body>
</html>
